<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Employer Dashboard - Merituno</title>

    <link rel="stylesheet" href="/home-page/style.css" />
    <link rel="stylesheet" href="/users/css/users.css" />
    <link rel="stylesheet" href="/users/css/employer.css" />

    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />

    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
    <script src="/login/js/auth.js"></script>
  </head>
  <body class="user-employer">
    <header>
      <div class="container">
        <div class="logo">
          <img src="/images/logo.png" alt="Merituno Logo" class="logo-icon" />
          <h1>Merituno</h1>
          <p>Employer Dashboard</p>
        </div>
        <nav>
          <ul>
            <li id="welcome-message">Loading...</li>
            <li class="profile-panel">
              <a href="#" id="profile-toggle">
                <i class="fas fa-user-circle"></i>
              </a>
              <div class="profile-dropdown">
                <div class="profile-header">
                  <i class="fas fa-building fa-2x"></i>
                  <div class="profile-info">
                    <strong id="profile-name">Employer</strong>
                    <div id="profile-email">employer@example.com</div>
                  </div>
                </div>
                <div class="profile-completion">
                  <div class="d-flex justify-content-between">
                    <span>Profile Completion</span>
                    <span id="profile-completion">0%</span>
                  </div>
                  <div class="progress">
                    <div
                      id="completion-progress"
                      class="progress-bar"
                      role="progressbar"
                      aria-valuenow="0"
                      aria-valuemin="0"
                      aria-valuemax="100"
                    ></div>
                  </div>
                </div>
                <a
                  href="#"
                  class="cta-button small"
                  onclick="showEditProfileModal()"
                  >Complete Profile</a
                >
                <!-- ADD LOGOUT LINK HERE -->
                <a href="#" class="logout-dropdown" id="logout-dropdown-btn">
                  <i class="fas fa-sign-out-alt"></i> Logout
                </a>
              </div>
            </li>
          </ul>
        </nav>
      </div>
    </header>

    <div class="dashboard-container">
      <div class="sidebar">
        <div class="nav-item active" data-section="dashboard">
          <i class="fas fa-th-large"></i> Dashboard
        </div>
        <div class="nav-item" data-section="job-management">
          <i class="fas fa-briefcase"></i> Job Management
        </div>
        <div class="nav-item" data-section="freelance-management">
          <i class="fas fa-users"></i> Freelance Management
        </div>
        <div class="nav-item" data-section="applications">
          <i class="fas fa-file-alt"></i> Applications
        </div>
        <div class="nav-item" data-section="wallet">
          <i class="fas fa-wallet"></i> Wallet
        </div>
        <div class="nav-item" data-section="chats">
          <i class="fas fa-comments"></i> Messages
        </div>
      </div>

      <div class="main-content">
        <!-- Dashboard Section -->
        <section id="dashboard" class="main-content-section active">
          <div class="company-card">
            <h3>Company Information</h3>
            <p id="company-description">
              No company description added yet.
              <a href="#">Complete your profile</a> to attract better
              candidates.
            </p>
          </div>

          <section class="stats">
            <div class="container">
              <div class="stat-item">
                <h3 id="active-jobs">0</h3>
                <p>Active Jobs</p>
              </div>
              <div class="stat-item">
                <h3 id="applications-received">0</h3>
                <p>Applications Received</p>
              </div>
              <div class="stat-item">
                <h3 id="hires-count">0</h3>
                <p>Successful Hires</p>
              </div>
              <div class="stat-item">
                <h3 id="satisfaction-rate">0%</h3>
                <p>Satisfaction Rate</p>
              </div>
            </div>
          </section>

          <section class="recent-activity">
            <div class="container">
              <div class="activity-header">
                <h2>Recent Activity</h2>
                <div class="activity-filters">
                  <button class="filter-btn active" data-filter="all">
                    All
                  </button>
                  <button class="filter-btn" data-filter="applications">
                    Applications
                  </button>
                  <button class="filter-btn" data-filter="projects">
                    Projects
                  </button>
                  <button class="filter-btn" data-filter="payments">
                    Payments
                  </button>
                </div>
              </div>

              <div class="activity-stats">
                <div class="stat-badge">
                  <i class="fas fa-bell"></i>
                  <span id="unread-count">3</span> Unread
                </div>
                <div class="stat-badge">
                  <i class="fas fa-clock"></i>
                  Last 7 days
                </div>
              </div>

              <div class="activity-feed" id="activity-feed">
                <!-- Activity items will be loaded dynamically -->
              </div>

              <div class="activity-footer">
                <button class="btn-secondary" id="load-more-activities">
                  <i class="fas fa-sync-alt"></i> Load More Activities
                </button>
                <button class="btn-text" id="mark-all-read">
                  <i class="fas fa-check-double"></i> Mark All as Read
                </button>
              </div>
            </div>
          </section>
        </section>

        <!-- Job Management Section -->
        <section id="job-management" class="main-content-section">
          <div class="job-management-actions">
            <button onclick="postNewJob()" class="btn-primary">
              Post New Job
            </button>
          </div>

          <div id="job-form-container" style="display: none">
            <div class="job-form-container">
              <h3 id="form-title">Post New Job</h3>
              <form id="job-form">
                <input type="hidden" id="job-id" value="" />
                <div class="form-group">
                  <label for="job-title">Job Title *</label>
                  <input
                    type="text"
                    id="job-title"
                    class="form-control"
                    required
                  />
                </div>
                <div class="form-group">
                  <label for="job-description">Description *</label>
                  <textarea
                    id="job-description"
                    class="form-control"
                    rows="4"
                    required
                  ></textarea>
                </div>
                <div class="form-group">
                  <label for="job-skills"
                    >Required Skills (comma separated)</label
                  >
                  <input type="text" id="job-skills" class="form-control" />
                </div>
                <div class="form-group">
                  <label for="job-star-requirement"
                    >Star Requirement (1-5)</label
                  >
                  <select id="job-star-requirement" class="form-control">
                    <option value="1">★</option>
                    <option value="2">★★</option>
                    <option value="3">★★★</option>
                    <option value="4">★★★★</option>
                    <option value="5">★★★★★</option>
                  </select>
                </div>
                <div class="form-group">
                  <label for="job-deadline">Deadline *</label>
                  <input
                    type="date"
                    id="job-deadline"
                    class="form-control"
                    required
                  />
                </div>
                <div class="form-group">
                  <label for="job-pay">Pay ($) *</label>
                  <input
                    type="number"
                    id="job-pay"
                    class="form-control"
                    min="0"
                    step="0.01"
                    required
                  />
                </div>
                <div class="form-group">
                  <label for="job-status">Status</label>
                  <select id="job-status" class="form-control">
                    <option value="open">Open</option>
                    <option value="closed">Closed</option>
                  </select>
                </div>
                <div class="form-actions">
                  <button type="submit" id="submit-job-btn" class="btn-primary">
                    Post Job
                  </button>
                  <button
                    type="button"
                    id="cancel-job-btn"
                    class="btn-secondary"
                  >
                    Cancel
                  </button>
                </div>
              </form>
            </div>
          </div>

          <div id="job-listing">
            <h3>Your Posted Jobs</h3>
            <div id="jobs-list" class="jobs-list">
              <!-- Jobs will be loaded here dynamically -->
            </div>
          </div>
        </section>

        <!-- Freelance Management Section -->
        <section id="freelance-management" class="main-content-section">
          <div class="freelance-management-actions">
            <button onclick="postNewFreelanceTask()" class="btn-primary">
              Post New Freelance Task
            </button>
          </div>

          <div id="freelance-form-container" style="display: none">
            <div class="freelance-form-container">
              <h3 id="freelance-form-title">Post New Freelance Task</h3>
              <form id="freelance-form">
                <input type="hidden" id="freelance-id" value="" />
                <div class="form-group">
                  <label for="freelance-title">Task Title *</label>
                  <input
                    type="text"
                    id="freelance-title"
                    class="form-control"
                    required
                  />
                </div>
                <div class="form-group">
                  <label for="freelance-description">Description *</label>
                  <textarea
                    id="freelance-description"
                    class="form-control"
                    rows="4"
                    required
                  ></textarea>
                </div>
                <div class="form-group">
                  <label for="freelance-skills"
                    >Required Skills (comma separated)</label
                  >
                  <input
                    type="text"
                    id="freelance-skills"
                    class="form-control"
                  />
                </div>
                <div class="form-group">
                  <label for="freelance-star-requirement"
                    >Star Requirement (1-5)</label
                  >
                  <select id="freelance-star-requirement" class="form-control">
                    <option value="1">★</option>
                    <option value="2">★★</option>
                    <option value="3">★★★</option>
                    <option value="4">★★★★</option>
                    <option value="5">★★★★★</option>
                  </select>
                </div>
                <div class="form-group">
                  <label for="freelance-deadline">Deadline *</label>
                  <input
                    type="date"
                    id="freelance-deadline"
                    class="form-control"
                    required
                  />
                </div>
                <div class="form-group">
                  <label for="freelance-pay">Pay ($) *</label>
                  <input
                    type="number"
                    id="freelance-pay"
                    class="form-control"
                    min="0"
                    step="0.01"
                    required
                  />
                </div>
                <div class="form-group">
                  <label for="freelance-status">Status</label>
                  <select id="freelance-status" class="form-control">
                    <option value="open">Open</option>
                    <option value="closed">Closed</option>
                  </select>
                </div>
                <div class="form-actions">
                  <button
                    type="submit"
                    id="submit-freelance-btn"
                    class="btn-primary"
                  >
                    Post Task
                  </button>
                  <button
                    type="button"
                    id="cancel-freelance-btn"
                    class="btn-secondary"
                  >
                    Cancel
                  </button>
                </div>
              </form>
            </div>
          </div>

          <div id="freelance-listing">
            <h3>Your Posted Freelance Tasks</h3>
            <div id="freelance-tasks-list" class="freelance-tasks-list">
              <!-- Freelance tasks will be loaded here dynamically -->
            </div>
          </div>
        </section>

        <!-- Applications Section -->
        <section id="applications" class="main-content-section">
          <h2>Applications Management</h2>

          <div class="applications-filter-container">
            <label for="applications-filter">Filter by status:</label>
            <select id="applications-filter" class="applications-filter">
              <option value="all">All Applications</option>
              <option value="pending">Pending</option>
              <option value="accepted">Accepted</option>
              <option value="rejected">Rejected</option>
            </select>
          </div>

          <div id="applications-list" class="applications-list">
            <!-- Applications will be loaded here dynamically -->
          </div>
        </section>

        <!-- Wallet Section -->
        <section id="wallet" class="main-content-section">
          <h2>Wallet Management</h2>

          <div class="wallet-balance-card">
            <h3>Current Balance</h3>
            <div id="wallet-balance" class="balance-amount">$0.00</div>
          </div>

          <div class="wallet-topup-section">
            <h3>Add Funds to Wallet</h3>
            <form id="topup-form" class="topup-form">
              <div class="form-group">
                <label for="topup-amount">Amount (USD)</label>
                <input
                  type="number"
                  id="topup-amount"
                  class="form-control"
                  min="1"
                  step="0.01"
                  required
                />
              </div>
              <button type="submit" class="btn-primary">Add Funds</button>
            </form>
          </div>

          <!-- Add this after the top-up section in your wallet HTML -->
          <div class="wallet-send-section">
            <h3>Send Money to Member</h3>
            <form id="send-money-form" class="send-money-form">
              <div class="form-group">
                <label for="recipient-email">Recipient Email</label>
                <input
                  type="email"
                  id="recipient-email"
                  class="form-control"
                  placeholder="Enter member's email"
                  required
                />
              </div>
              <div class="form-group">
                <label for="send-amount">Amount (USD)</label>
                <input
                  type="number"
                  id="send-amount"
                  class="form-control"
                  min="0.01"
                  step="0.01"
                  required
                />
              </div>
              <div class="form-group">
                <label for="send-description">Description (Optional)</label>
                <input
                  type="text"
                  id="send-description"
                  class="form-control"
                  placeholder="e.g., Payment for completed project"
                />
              </div>
              <button type="submit" class="btn-primary">Send Money</button>
            </form>
          </div>

          <div class="transactions-section">
            <h3>Transaction History</h3>
            <div id="transactions-list" class="transactions-list">
              <!-- Transactions will be loaded here dynamically -->
            </div>
          </div>
        </section>
        <!-- Chats Section -->
        <section id="chats" class="main-content-section">
          <div class="section-header">
            <h2>Project Messages</h2>
            <p>Communicate with candidates about projects</p>
          </div>

          <!-- Chats List -->
          <div id="chats-list">
            <div class="content-grid">
              <!-- Chats will load here dynamically -->
            </div>
          </div>

          <!-- Chat Window (hidden by default) -->
          <div id="chat-window" style="display: none">
            <div class="content-card">
              <div class="card-header">
                <div class="chat-header-content">
                  <h3 id="chat-title">Project Chat</h3>
                  <div id="chat-subtitle" class="chat-subtitle">Loading...</div>
                </div>
                <button class="card-action" onclick="closeChat()">
                  Close Chat
                </button>
              </div>

              <div class="card-content">
                <div
                  id="messages-container"
                  style="
                    height: 400px;
                    overflow-y: auto;
                    border: 1px solid #eee;
                    padding: 15px;
                    margin-bottom: 15px;
                    border-radius: 8px;
                  "
                >
                  <!-- Messages will appear here -->
                </div>

                <div style="display: flex; gap: 10px; align-items: center">
                  <input
                    type="text"
                    id="message-input"
                    placeholder="Type your message..."
                    style="
                      flex: 1;
                      padding: 12px;
                      border: 1px solid #ddd;
                      border-radius: 6px;
                    "
                    onkeypress="if(event.key === 'Enter') sendMessage()"
                  />
                  <button
                    onclick="sendMessage()"
                    class="card-action"
                    style="padding: 12px 20px"
                  >
                    Send
                  </button>
                </div>
              </div>
            </div>
          </div>
        </section>
      </div>
    </div>

    <footer>
      <div class="container">
        <div class="footer-content">
          <div class="footer-section">
            <h3>Merituno</h3>
            <p>Learn • Earn • Grow</p>
          </div>
          <div class="footer-section">
            <h4>Employer Resources</h4>
            <ul>
              <li><a href="#">Hiring Guide</a></li>
              <li><a href="#">Pricing Plans</a></li>
            </ul>
          </div>
          <div class="footer-section">
            <h4>Support</h4>
            <p>employer@merituno.com</p>
          </div>
        </div>
        <div class="footer-bottom">
          <p>&copy; 2025 Merituno. All rights reserved. | Employer Dashboard</p>
        </div>
      </div>
    </footer>

    <!-- Corrected JavaScript paths -->
    <script src="/users/js/employer/main.js"></script>
    <script src="/users/js/employer/jobs.js"></script>
    <script src="/users/js/employer/freelance.js"></script>
    <script src="/users/js/employer/applications.js"></script>
    <script src="/users/js/employer/wallet.js"></script>
  </body>
</html>
